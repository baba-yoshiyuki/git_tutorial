# コマンド集（備忘録）
## ファイル作成
- git init（gitリポジトリを直下に作成する）  
- git clone <リポジトリURL>（すでにあるgitリポジトリをコピーする）  
- git remote add origin <URL> （originというショートカットでurlのリモートリポジトリを登録する）  
    - リモートリポジトリは複数登録できる  

## 状況確認
- git status （変更状況確認）
- git diff （変更確認）
    - git diff <ファイル名> （ファイルの変更確認）
    - git diff --staged （addしたファイルとリポジトリの変更差分を確認）
- git log （変更履歴を確認する）
    - git log --oneline （一行表示する）
    - git log -p <ファイル名> （ファイルの変更履歴を表示する）
    - git log -n <コミット数> （過去のいくつかのコミットのみさかのぼる）
- git remote -v （リモートに登録されているリポジトリを確認）
- git remote show <リモート名>（リモートの詳細情報を表示する）
- git tag （タグを表示）
    - git tag -l <文字列> （パターンを指定してタグを表示する）
- git stash list （避難したstashのリストを表示する）

## ファイルを追加・変更・削除
- git add <ファイル> （変更をステージにアップ）
- git commit （ステージの変更をリポジトリに記録する）
    - git commit -m "<メッセージ>"（コミットメッセージを記載）
    - git commit -v （エディター上で変更内容を確認できる）
- git rm <ファイル名> （ファイル削除）
    - git rm -r <ディレクトリ名> （ディレクトリ削除）
    - git rm --cached <ファイル名> （gitリポジトリのみからファイル削除。ローカルには残る）
- git mv <旧ファイル> <新ファイル> （ファイルの移動、ファイル名の変更を記録する）
    - mv  <旧ファイル> <新ファイル> → git rm  <旧ファイル> → git add <新ファイル>と同等
- git restore <ファイル名/ディレクトリ名> （ファイルの変更を取り消す）
    - git checkout -- <ファイル名/ディレクトリ名> （ファイルの変更を取り消す、古いやつ）
    - git checkout -- . （全変更を取り消す、古いやつ）
    - git restore --staged <ファイル名/ディレクトリ名> （ステージした変更を取り消す）
    - git reset HEAD <ファイル名/ディレクトリ名> （ステージした変更を取り消す、古いやつ）
    - git reset HEAD . （全変更を取り消す、古いやつ）
- git commit --amend （直前のコミットをやり直す）
    - リモートリポジトリにPushしたコミットはやり直してはいけない
    - もう一度新しいコミットを作って修正したほうが良い（変更点はのこすべきだし、上記注意点もあるから）
- git push <リモート名> <ブランチ名> （変更をリモートリポジトリにプッシュ）

## リモートの変更を取得する
- git fetch <リモート名> （リモートリポジトリからローカルリポジトリに情報を持ってくる、ローカルワークツリーは変更されない）
    - ステージの変更のみを取り消すので、ローカルのワークツリーの変更は取り消されない
- git pull <リモート名> <ブランチ名> （リモートの変更をローカルのワークツリーに反映）
    - git fetch + git mergeと同じ
    - 今いるブランチにpullしてきたブランチがマージされてしまうので注意！
    - git pull --rebase <リモート名> <ブランチ名> （リモートの変更をローカルのワークツリーに反映、rebaseするのでマージコミットが残らない）
        - git config --global pull.rebase true （pullするときにデフォルトでrebase型になる）
        - git config branch.master.rebase true（masterをpullするときにrebase型になる）

## リモートリポジトリ操作
- git remote rename <旧リモート名> <新リモート名> （リモート名を変更する）
- git remote rm <リモート名> （リモートを削除）

## ブランチ管理
- git branch <ブランチ名> （ブランチを新規作成する、切り替えは行わない）
    - git checkout -b <ブランチ名> （ブランチを新規作成して切り替える）
- git branch （ブランチの一覧を表示する）
    - git branch -a （リモートリポジトリを含めたすべてのブランチを表示する）
- git checkout <既存ブランチ名> （ブランチを切り替える）
- git merge <マージ元ブランチ名> （今いるブランチにマージ元ブランチの変更を取り込む）
- git branch -m <ブランチ名> （ブランチの名前を変更）
- git branch -d <ブランチ名> （ブランチを削除する、masterにマージされていない変更がある場合削除しない）
- git branch -D <ブランチ名> （ブランチを強制削除する）

## タグ管理
- git tag （タグを表示）
    - git tag -l <文字列> （パターンを指定してタグを表示する）
- git tag -a <タグ名> -m '<メッセージ>' （注釈付きタグを作成する）
    - タグ名＋メッセージ＋作成者がつく
- git tag <タグ名> （軽量版タグを作成する） 
    - タグ名のみつく
    - git tag <タグ名> <コミット名> （過去のコミットにタグ付けする）
- git show <タグ名> （タグのデータを表示する）
- git push <ブランチ名> <タグ名> （タグをリモートリポジトリに送信する）
    - git push origin --tags （タグを一斉送信する）

## 作業の一時退避
- git stash （作業を一時退避する）
- git stash apply （最新の作業を復元する）
- git stash apply --index （ステージの状況も復元する）
- git stash apply <スタッシュ名> （特定の作業を復元する）
    - git stash apply stash@{1}
- git stash drop （最新の作業を削除する）
- git stash drop <スタッシュ名> （特定の作業を削除する）
- git stash clear （全作業を削除する）

## コミットを整理する
- git rebase <ブランチ名> （ブランチの基点となるコミットを別のコミットに変更する）
- git rebase -i <コミットID> （対話的リベース）
    - git rebase HEAD~n （HEADを基点にしてn分の親コミットまで指定する）
    - やり直したいコミットのpickをeditに書き直す
    - やり直したらgit commit --amendを実行する
    - 次のコミットへ進む git rebase --continue
    - コミットを直前のコミットとまとめるときはpickをsquashにまとめる

# 役立つ知識
- .gitignore作成
    - gitに認識してほしくないファイル（画像やパワポ資料など）をgitに認識させないように設定できる
    - \#をつけるとコメントがかける
    - /<フォルダ名> と記載することでフォルダ直下を無視
    - /* とすると全フォルダ選択

- コンフリクトとは
    - 同じファイルの同じ行に対して異なる編集を行ったときに発生する
    - 解決するには、コンフリクトしたファイルを編集し、ファイルの内容を書き換える（<<<< ==== >>>>>の部分を修正する）
    - コンフリクトファイルを特定するには、コンフリクトしたブランチでgit status する→ both modifiedとなっているファイル
- コンフリクトを防ぐには
    - 複数人で同じファイルを変更しない
    - pullやmergeをする前に変更中の状態をなくしておく（commitやstashをしておく）
    - pullするときはpullするブランチに移動してからpullする
- GitHubでプルリクエストを送る
    - ローカルでの変更をpushする
    - GitHubサイトでPull requestを作成する
    - 作成したらレビュワーを設定する
    - レビューもらったらローカルで対応して変更を再度pushする
    - レビュー完了したらレビュワーは承認ボタン押す
    - レビューの承認がおりたらmergeボタンでマージする
    - マージ後不要になったブランチをリモートとローカルから削除する

- リベースとは
    - 変更を統合する際に、履歴をきれいに整えるために使う
    - git rebase <ブランチ名> （ブランチの基点となるコミットを別のコミットに変更する）
        - 履歴を整えながら、別ブランチの変更を取り込める
    - マージとの違いは、リベースは履歴が一直線になるが、マージでは履歴が枝分かれする
    - GitHubにpushしたコミットはrebaseしてはいけない！（rebaseしたブランチがリモートにpushできなくなる）
        - git push -f で強制pushできるが、gitの履歴が壊れてしまうので絶対NG

- タグとは
    - コミットを参照しやすくするためにわかりやすい名前をつける
    - 2種類ある（annotated：詳細版, lightweight：簡易版）

# 感想
Git運用で必要なコマンドを仕組みから理解できたのでよかった。  
コマンドだけ覚えて裏で何が起こっているのか理解できていなかったので今回それが学べてよかった。